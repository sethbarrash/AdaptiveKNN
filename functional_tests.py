import unittest
import numpy as np
import ktree

class TestZhang(unittest.TestCase):

    def test0(self):
        X = np.array([[2.99539306, 9.70447026, 1.58066472, 5.4736579 , 4.03835706],
            [7.36527802, 7.19202248, 5.23941664, 4.62359315, 2.78405493],
            [0.8569416 , 7.75992884, 9.26903748, 2.43733902, 0.97433429],
            [7.45532764, 7.24948377, 5.83242563, 4.10501055, 1.067955  ],
            [2.48536416, 8.8980045 , 9.73364887, 7.81808237, 9.70909664],
            [2.46313415, 1.14326393, 4.45132617, 5.92438334, 0.54972674],
            [3.94457148, 1.21956568, 9.73720624, 3.39058295, 9.14451752],
            [1.49982528, 1.27267333, 8.44744328, 9.32665067, 4.04330487],
            [4.69369211, 9.36780698, 0.82042423, 3.50962069, 9.22407332]])

        rho1 = 0.001
        rho2 = 0.001
        k = 5
        sigma = 0.001

        W = ktree.optimize(X, rho1, rho2, k, sigma)
        valid = ktree.check_optimality(W, X, rho1, rho2, k, sigma)
        self.assertTrue(valid)